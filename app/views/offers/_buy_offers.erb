<h1>Offers for <%= "Gate Number: #{@gate.number}: #{@gate.horse.name}" %></h1>

<h2>Listing Sell Offers</h2>
<h5>What it would cost to Buy, Go Long or Back a contract on <%= "Gate Number: #{@gate.number}: #{@gate.horse.name}" %>
<%= link_to 'Buy One Contract at Market', buy_contracts_path(:gate_id => @gate.id, :market => 'Market', :number => 1, :offer_type => 'Buy'), :class => 'btn btn-success', data: { confirm: 'Are you sure? This will buy one contract at Market.'} %>

<%= link_to 'New Sell Offer', new_offer_path(:gate_id => @gate.id, :offer_type => 'Sell'), :class => 'btn btn-success' %>
<table class='table table-striped table-bordered table-condensed' id='buy_offers'>
  <tr>
    <th>Position</th>
    <th>Player</th>
    <th>Price</th>

    <th>Expires</th>

    <th>Number</th>

  </tr>

<% @sell_offers.each_with_index do |offer, index| %>
  <%if index == 0 and offer.user.id != current_user.id %>
    <tr class='market'>
  <%elsif offer.user.id == current_user.id %>
    <tr class='same'>
  <%else%>
    <tr>
  <% end %>
    <td><%= index + 1 %></td>
    <td><%= offer.user.name %></td>
    <td><%= offer.price %></td>
    <td><%= distance_of_time_in_words_to_now(offer.expires) unless offer.expires.blank? %></td>
    <td><%= offer.number %></td>
  <%if index == 0 and offer.user.id != current_user.id %>
    <td><%= link_to 'Buy', buy_contracts_path(:gate_id => @gate.id, :market => 'Market', :number => 1, :offer_type => 'Buy', :offer_id => offer.id), :class => 'btn btn-success', data: { confirm: 'Are you sure? This will buy one contract at Market.'} %></td>
  <%end%>
  </tr>
<% end %>

</table>

